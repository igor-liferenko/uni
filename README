Note about using mbsnrtowcs() library function*:
If return value is not -1, the input string may end with complete or incomplete sequence,
and it is impossible to determine this.
If return value is -1, *src will point to the beginning of the failed sequence
(but only if dest is not NULL).

* - In glibc; TODO - check in musl.

See the following links where this is confirmed:

https://sourceware.org/bugzilla/show_bug.cgi?id=21092
https://sourceware.org/bugzilla/show_bug.cgi?id=21093

Instead of mbsnrtowcs() use wcsntomos() - see cweb-git/utf8/.
